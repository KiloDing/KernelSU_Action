KERNEL_SOURCE=https://github.com/MiCode/Xiaomi_Kernel_OpenSource.git
KERNEL_BRANCH=pipa-t-oss
KERNEL_CONFIG=pipa_user_defconfig   # 确认：pipa 源码 arch/arm64/configs/ 下常见为 pipa_user_defconfig 或 pipa_defconfig；如果编译失败日志报 defconfig 不存在，再换成 pipa_defconfig 测试
ARCH=arm64
KERNEL_IMAGE_NAME=Image.gz-dtb     # pipa (sm8250) 系列标准输出，通常就是 Image.gz-dtb

# 编译器设置：强烈推荐用 Proton-Clang（避开 AOSP 旧版 404，兼容性最好、优化强）
CUSTOM_CLANG_SOURCE=https://github.com/kdrag0n/proton-clang.git
CUSTOM_CLANG_BRANCH=master         # 或固定最新 tag，如 proton-clang-20250301（查看 repo tags）

# 如果坚持用 AOSP（不推荐，旧版已移除），用最新版：
# CLANG_VERSION=r547379             # 2025 年最新 Clang 20.0.0（当前可用）
# CLANG_BRANCH=main                 # AOSP prebuilts 现在用 main 分支

ENABLE_GCC_64=true
ENABLE_GCC_32=true

EXTRA_CMDS=LLVM=1 LLVM_IAS=1

# KernelSU（非 GKI 必须旧版）
ENABLE_KERNELSU=true
KERNELSU_TAG=v0.9.5
ADD_KPROBES_CONFIG=true
ADD_OVERLAYFS_CONFIG=true
APPLY_KERNELSU_PATCH=true          # 如果自动注入失败，再手动

# 优化旗标（强烈建议全开，避免常见错误）
DISABLE_LTO=true
DISABLE_CC_WERROR=true
ENABLE_CCACHE=true
REMOVE_UNUSED_PACKAGES=true

# AnyKernel3 打包
CUSTOM_ANYKERNEL3_SOURCE=https://github.com/osm0sis/AnyKernel3.git
ANYKERNEL3_BRANCH=master

# 打包 boot.img（推荐）
BUILD_BOOT_IMG=true                # 修正：应该是 true，不是 flash（Action 只认 true/false）
SOURCE_BOOT_IMAGE=https://your-link-to-stock-boot.img   # 必须替换成真实直链！从相同 HyperOS/MIUI 版本的官方 fastboot ROM 提取 boot.img，上传到 GitHub Release raw 或其他永久直链服务（如 telegram 文件、mega 等）
NEED_DTBO=true                     # pipa 需要 dtbo.img
